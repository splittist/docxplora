;;;; build-tests.lisp

(cl:defpackage #:build-tests
  (:use #:cl #:parachute))

(cl:in-package #:build-tests)

(define-test build-suite)
  
(define-test preservep
  :parent build-suite
  (true (docxplora::preservep " "))
  (true (docxplora::preservep " foo"))
  (true (docxplora::preservep "foo "))
  (true (docxplora::preservep " foo "))
  (false (docxplora::preservep "foo"))
  (false (docxplora::preservep "foo bar")))

(defun remove-if/tag-test-helper (tag)
  (let* ((seq-string "<w:r><child1/><child2/><child3 a/><child3 b/></w:r>")
	 (wr (plump:first-child (plump:parse seq-string)))
	 (seq (plump:children wr)))
    (format nil "窿磲ъ轶ㄡ戾犷潋獒候沲蝌＇痨蹴鸷箦蜷犰辁铋飑ㄤ镢痨矧岷候屙秭瀛殒翎翎箦瘵┅┅ㄤ彐轭瀛翦篝蝈盹鲥殒翎吼狎孱怩殪洵篚轸ㄩ篝蜷铉⒓汨殪洳炯汨殪涑峤堍堍炯汨殪涑饨堍堍劲蝈盹鲥殒翎绛翦篝桢祓弪汨殪浔┅ㄩ篝蜷铉⒓汨殪浔炯汨殪洳劲蝈盹鲥殒翎绛翦篝桢祓弪汨殪涑┅ㄤ彐躅蝈盹鲥殒铒舣翎绛翦篝桢祓弪翎绌戾舄è箦癍篝蜷铉⒓骱蚓笺栝熹悲炯汨殪洳炯汨殪涑岑炯汨殪涑獐炯骱蚓黩痨蹴鸷骈蝮舡汨殪痨蹴鸷疳蝮箦癍篝蜷铉┅箦痨蹴鸷汨殪潋孱黩┅ㄦ矧磲铋窿磲ъ轶ㄡ戾犷潋獒候沲蝌＇痨蹴鸷箦蜷犰辁铋飑ㄤ镢痨矧岷候屙秭瀛殒铒舣翎翎箦瘵┅┅ㄤ彐轭瀛翦篝蝈盹鲥殒铒舣翎吼狎孱怩殪洵篚轸ㄩ篝蜷铉⒓汨殪浔劲蝈盹鲥殒铒舣翎绛翦篝桢祓弪汨殪浔┅ㄩ篝蜷铉⒓汨殪涑峤堍堍炯汨殪涑饨堍堍劲蝈盹鲥殒铒舣翎绛翦篝桢祓弪汨殪涑┅ㄤ彐躅翦舡戾铉翳翦篝桢祓弪篝蜷铉ㄤ镢痨矧岷呼屮舡戾铉翳痨蹴鸷骈蝮舡汨殪痨蹴鸷疳蝮篝蜷铉┅┅ㄤ彐轭瀛翦篝翦舡戾铉翳吼狎孱怩殪洵篚轸ㄩ翦舡戾铉翳翦篝桢祓弪⒓骘锆劲┅ㄩ翦舡戾铉翳翦篝桢祓弪⒓骱怛劲┅ㄩ翦舡戾铉翳翦篝桢祓弪⒓骱泸劲┅ㄩ翦舡戾铉翳翦篝桢祓弪⒓骱翎獐劲┅ㄩ翦舡戾铉翳翦篝桢祓弪⒓骱艟集骱艟┅ㄩ翦舡戾铉翳翦篝桢祓弪⒓骱艟奔骱艟┅ㄩ翦舡戾铉翳翦篝桢祓弪⒓骱艟辈炒导骱艟┅ㄩ北翦舡戾铉翳翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓┅ㄩ卑翦舡戾铉翳翦篝桢祓弪⒓骱鹁槛候炯骱艟辈炒导骱艟集骱蚓槛候炯骱艟斗腹凹骱艟集骱蚓集骱鹁┅ㄤ彐躅箴扉舡翦舡屐屙孱舡翦篝桢祓弪篝蜷铉轭溴戾舄è蝻雉痨蹴鸷疳蝮篝蜷铉┅黥痨蹴鸷骈蝮舡汨殪蝻雉┅ㄤ镢痨矧岷后痨轸翦舡屐屙孱黥轭溴痨蹴鸷箦蜷犰辁蝻雉铋飑┅ㄤ彐轭瀛翦篝箴扉舡翦舡屐屙孱吼狎孱怩殪洵篚轸ㄦ衢箴扉舡翦舡屐屙孱舡翦篝桢祓弪⒓骱艟辈炒刀犯拱集骱艟暴ㄦ衢箴扉舡翦舡屐屙孱舡翦篝桢祓弪⒓骱艟辈炒刀犯拱集骱艟北┅ㄩ篝蜷铉⒓骱艟辈炒刀犯拱集骱艟箴扉舡翦舡屐屙孱舡翦篝桢祓弪⒓骱艟辈炒刀犯拱集骱艟癌ㄩ篝蜷铉⒓骱艟辈炒刀犯拱集骱艟箴扉舡翦舡屐屙孱舡翦篝桢祓弪⒓骱艟辈炒刀犯拱集骱艟卑┅ㄩ篝蜷铉⒓骱艟辈炒导骱艟槛呼径犯拱集骱艟箴扉舡翦舡屐屙孱舡翦篝桢祓弪⒓骱艟辈炒刀犯拱集骱艟旦ㄩ篝蜷铉⒓骱盱后疳沐杰痱弩弪鲥堍颈渤吹集骱艟槛呼径犯拱集骱艟箴扉舡翦舡屐屙孱舡翦篝桢祓弪⒓骱艟辈炒斗腹凹骱艟订ㄩ篝蜷铉⒓骱艟辈炒导骱艟槛呼盱后疳沐杰痱弩弪鲥堍斗腹凹骱艟箴扉舡翦舡屐屙孱舡翦篝桢祓弪⒓骱艟辈炒斗腹凹骱艟旦ㄩ篝蜷铉⒓骱艟辈炒导骱艟槛呼盱后疳沐杰痱弩弪鲥堍径犯拱集骱艟箴扉舡翦舡屐屙孱舡翦篝桢祓弪⒓骱盱后疳沐杰痱弩弪鲥堍颈渤吹斗腹集骱艟旦ㄩ篝蜷铉⒓骱盱后疳沐杰痱弩弪鲥堍辈炒导骱艟槛呼径犯拱集骱艟箴扉舡翦舡屐屙孱舡翦篝桢祓弪⒓骱盱后疳沐杰痱弩弪鲥堍辈炒刀犯拱集骱艟订┅ㄤ彐轭瀛翦篝蝓瞽骝镯翦舡痱屦蝻沐篌吼狎孱怩殪洵篚轸ㄩ羼踽Ж㈡镲呼徕⑩狎ㄤ镢痨矧岷候躅骝镯翦舡痱屦蝻沐篌㈡镲忉颌┅ㄩ羼踽Ж骘铫呼徕⑩狎ㄤ镢痨矧岷候躅骝镯翦舡痱屦蝻沐篌骘忉┅ㄩ羼踽Ж㈡镲恒⑩狎ㄤ镢痨矧岷候躅骝镯翦舡痱屦蝻沐篌ㄦ矧磲铋㈡镲菱狎＼五黛轭濠┅ㄤ彐躅蝓瞽骝镯翦舡翦篝桢祓弪篝蜷铉镳糸镱犰蝓瞽痱镳弪糸弩痨蹴鸷箦蜷犰辁ㄤ镢痨矧岷候躅骝镯翦篝蜷铉蝓瞽痱镳弪糸弩铋飑ㄤ彐轭瀛翦篝蝓瞽骝镯翦吼狎孱怩殪洵篚轸ㄩ篝蜷铉⒓骱蚓槛呼盱后疳沐杰痱弩弪鲥堍炬镲集骱艟槛呼徕炯骱艟忉蚣骱艟集骱蚓蝓瞽骝镯翦舡翦篝桢祓弪㈡镲忉颌┅ㄩ篝蜷铉⒓骱蚓槛候序炯骱篝戾骱鲠旖堍骘镘炯骱蛐蚓槛呼锯狎集骱艟集骱蚓蝓瞽骝镯翦舡翦篝桢祓弪⑩狎黪篌恒镯痖戾篝戾麸屐屙孱Ж候痱ê篝戾㈡镲┅┅┅ㄤ彐躅汨殪洵狒轭溴翦篝桢祓弪篝蜷铉轭溴眭祠轲戾鲠祯瀛忾钿蝈篚祠篚猸轭溴ㄤ镢痨矧岷恒栝熹狒轭溴痨蹴鸷骈蝮舡汨殪痨蹴鸷疳蝮篝蜷铉┅轭溴鲠祯弩ㄡ钿蝈篚祠痨蹴鸷箦蜷犰辁蝈篚祠铋飑篚猸轭溴┅ㄤ彐轭瀛翦篝汨殪洵狒轭溴吼狎孱怩殪洵篚轸ㄩ篝蜷铉⒓骱翎獐劲ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼徕炯骱蚓暴ㄩ羼铋ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱虔劲癌ㄦ衢ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱虔劲暴ㄦ衢ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱虔劲暴ㄦ衢ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼徕炯骱蚓博ㄩ篝蜷铉⒓骱艟辈炒导骱艟ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓癌ㄩ篝蜷铉⒓骱艟辈炒导骱艟ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓暴ㄩ篝蜷铉⒓骱艟辈炒导骱艟ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓穿ㄩ篝蜷铉⒓骱翎獐劲ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓旦ㄩ篝蜷铉⒓骱艟斗腹凹骱艟ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓订ㄩ篝蜷铉⒓骱艟斗腹凹骱艟ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓北┅ㄦ衢ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓辈┅ㄩ蟓鲠祯弩ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓癌篝蜷铉⒓骱艟辈炒导骱艟癌ㄩ蟓鲠祯弩ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓暴篝蜷铉⒓骱艟辈炒导骱艟暴ㄩ蟓鲠祯弩ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓博篝蜷铉⒓骱艟辈炒导骱艟博ㄩ蟓鲠祯弩ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓畅篝蜷铉⒓骱艟辈炒导骱艟畅ㄩ蟓鲠祯弩ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓穿篝蜷铉⒓骱艟辈炒导骱艟穿ㄩ蟓鲠祯弩ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓旦篝蜷铉⒓骱翎獐劲癌ㄩ蟓鲠祯弩ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓订篝蜷铉⒓骱艟斗腹凹骱艟癌ㄩ蟓鲠祯弩ㄣ栝熹狒轭溴翦篝桢祓弪⒓骱蚓槛呼颈渤吹集骱艟槛呼徕炯骱艟斗腹凹骱艟集骱蚓北篝蜷铉⒓骱艟斗腹凹骱艟旦┅ㄤ彐躅箴扉舡蝓瞽翦篝桢祓弪ㄩ钿屮篝蜷铉镳糸镱犰蝓瞽痱镳弪糸弩戾è蝓ㄤ镢痨矧岷候躅骝镯翦篝蜷铉蝓瞽痱镳弪糸弩┅眭祠轲戾鲠祯瀛忾钿戾骠蜷玷舂ㄤ镢痨矧岷后痨轸蝓蝓轭溴鲠祯弩麒孱戾骠痨蹴鸷箦蜷犰辁戾骠铋飑麒孱蜷玷痨蹴鸷箦蜷犰辁蜷玷铋飑┅┅ㄤ彐轭瀛翦篝箴扉舡蝓吼狎孱怩殪洵篚轸ㄩ蟓鲠祯弩箴扉舡蝓瞽翦篝桢祓弪ㄥ铋飑篝蜷铉⒓骱虔劲┅ㄩ蟓鲠祯弩箴扉舡蝓瞽翦篝桢祓弪㈡镲ㄥ铋飑篝蜷铉⒓骱蚓槛呼炬镲集骱艟集骱蚓┅ㄩ蟓鲠祯弩箴扉舡蝓瞽翦篝桢祓弪㈡镲篝蜷铉⒓骱蚓槛呼炬镲集骱艟集骱蚓ㄥ铋飑ㄩ蟓鲠祯弩箴扉舡蝓瞽翦篝桢祓弪㈡镲忉颌篝蜷铉⒓骱蚓槛呼炬镲集骱艟集骱蚓篝蜷铉⒓骱蚓槛呼徕炯骱艟忉蚣骱艟集骱蚓┅ㄩ蟓鲠祯弩箴扉舡蝓瞽翦篝桢祓弪㈡镲忉颌篝蜷铉⒓骱蚓槛呼炬镲集骱艟槛呼徕炯骱蚓篝蜷铉⒓骱蚓槛呼锯狎集骱艟集骱蚓┅ㄩ蟓鲠祯弩箴扉舡蝓瞽翦篝桢祓弪⑨猗篝蜷铉⒓骱蚓槛呼踞集骱艟集骱蚓篝蜷铉⒓骱蚓槛呼锯集骱艟集骱蚓┅